# [機能名/クラス名] 設計仕様書

## 1. 概要
このモジュールが解決する課題や、システム内での役割を簡潔に記述します。
例：計算グラフにおける逆伝播の自動実行と世代管理。

## 2. クラス/構造体 定義
C言語での実装を意識し、メンバ変数を表形式で整理します。

| 変数名 | 型 (Python/C) | 説明 | 備考 |
| :--- | :--- | :--- | :--- |
| `data` | `ndarray / double*` | インスタンスが保持する実データ | |
| `grad` | `ndarray / double*` | データの勾配（微分値） | 初期値はNone/NULL |
| `generation` | `int / int` | 計算グラフ上の世代 | 0から開始 |

## 3. メソッド/関数 インターフェース
「呼び出し方」の約束事を定義します。

### `backward(self)`
- **役割**: 自身の勾配を起点として、逆伝播を自動的に実行する。
- **引数**: なし
- **戻り値**: なし

## 4. 処理フロー
箇条書き、または Mermaid（図解）を使用して、ロジックの「順序」を記述します。

1. **初期化**: 自身の `grad` が `None` なら `1.0` で埋める。
2. **キュー準備**: 優先度付きキュー `funcs` を作成し、`creator` を追加。
3. **ループ実行**: キューが空になるまで以下を繰り返す。
    - 3.1. `heappop` で最大世代の関数 `f` を取得。
    - 3.2. ...（以下続く）

## 5. 改修履歴 / 変更点
旧バージョンからの変更理由と内容を簡潔にまとめます。
- **変更点**: リストによるソートから `heapq` による優先度付きキューへ変更。
- **理由**: 計算グラフが複雑化した際の検索コスト削減（$O(N \log N) \to O(\log N)$）。